<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <title>Musutafu Town Hall Home Page</title>
</head>
<body>
    <nav>
        <a href="complaint-registration.html">File A Complaint</a>
        <a href="login.html">Council Member Login</a>
    </nav>
    <h1>Welcome to the Musutafu Town Hall Homepage</h1>
<!-- link to complaint form
login bar at the top
Display all town meetings here
if council member logs in? Direct to a page with all the complaints shown, 
where they can also set status of complaints and create meetings
-->

    <table>
        <thead>
            <h2>Upcoming Meetings (Subject to Change)</h2>
            <tr><th>Meeting ID</th><th>Address</th><th>Time</th><th>Summary</th></tr>  
        </thead>
        <tbody id="meetingTableBody">

        </tbody>
    </table>
</body>
<script>

    const meetingTableBody = document.getElementById("meetingTableBody");

    //pulling a list of all meetings that were created from create-meeting html.
    async function getMeetings(){
        const httpResponse = await fetch("http://localhost:8080/meetings")
        const meetings = await httpResponse.json();
        console.log(meetings);
        return meetings;

    }

    async function renderMeetingTable(){
        
        const testMeetings = await getMeetings();
        //
       
        for (var i = 0; i <testMeetings.length;i++){

            const meetingRow = document.createElement("tr");

            const meetingIdData = document.createElement("td");
            meetingIdData.innerText = testMeetings[i].meetingId;

            const meetingAddressData = document.createElement("td");
            meetingAddressData.innerText = testMeetings[i].address;
            
            const meetingTimeData = document.createElement("td");
            const readableDate = new Date(testMeetings[i].time*1000); 
            meetingTimeData.innerText = readableDate.toLocaleString();

            const meetingSummaryData = document.createElement("td");
            meetingSummaryData.innerText = testMeetings[i].summary;

            meetingRow.appendChild(meetingIdData);
            meetingRow.appendChild(meetingAddressData);
            meetingRow.appendChild(meetingTimeData);
            meetingRow.appendChild(meetingSummaryData);

            meetingTableBody.appendChild(meetingRow);

        }
    
    }
    renderMeetingTable();

</script>
