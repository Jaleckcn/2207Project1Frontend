<!DOCTYPE html>
<html lang="en">
<head>
    <title>Registered User Login</title>
</head>
<body>
    <h2>Login</h2>

    <form>
        <fieldset>
            <legend>Login</legend>

            <label for="usernameInput">Username</label>
            <input id="usernameInput" type="text" placeholder="jim99">

            <label for ="passwordInput">Password</label>
            <input id="passwordInput" type="password">

            <button>Login</button>
        </fieldset>
    </form>
</body>
<script>

    const usernameInput = document.getElementById("usernameInput");
    const passwordInput = document.getElementById("passwordInput");

    document.addEventListener("submit", async event => {
        event.preventDefault();
        
        //async function that gets data

        const username = usernameInput.value;
        const password = passwordInput.value;
        const credentials = {username, password};

        const httpResponse = await fetch("http://localhost:8080/login", {
            method:"POST",
            body:JSON.stringify(credentials),
            headers:{
            'Content-Type':"application/json"
            }
        });

        if(httpResponse.status === 200){
        const employee = await httpResponse.json();
        alert("login successful");
        window.location = "complaint-viewer.html"
        //this will transfer user to this page
        employee.password = null;

        localStorage.setItem("employee",JSON.stringify(employee));
        localStorage.getItem("employee"); //retrieve from local storage
        localStorage.clear;
        
        }

        if(httpResponse.status === 404){
            alert("username not found");
        }

        if(httpResponse.status === 400){
            alert("password does not match");
        }

    });



</script>
</html>